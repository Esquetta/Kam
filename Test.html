<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAM NEURAL // CORE v3.5</title>
    <style>
        :root {
            --bg: #050505;
            --sidebar-bg: rgba(0, 0, 0, 0.95);
            --card-bg: rgba(15, 15, 15, 0.85);
            --border: rgba(255, 255, 255, 0.12);
            --text: #ffffff;
            --accent: #00d4ff;
            --mono: 'IBM Plex Mono', monospace;
            --color-research: #a855f7;
            --color-analyzer: #22c55e;
            --color-task: #eab308;
            --color-system: #ef4444;
        }

        [data-theme="light"] {
            --bg: #f2f2f2;
            --sidebar-bg: rgba(255, 255, 255, 0.98);
            --card-bg: rgba(240, 240, 240, 0.9);
            --border: rgba(0, 0, 0, 0.15);
            --text: #121212;
        }

        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            background: var(--bg);
            color: var(--text);
            font-family: 'Inter', sans-serif;
            overflow: hidden;
        }

        #webgl-canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1;
            pointer-events: none;
            mix-blend-mode: exclusion;
            opacity: 0.3;
        }

        .app-shell {
            display: grid;
            grid-template-columns: 80px 1fr 300px;
            height: 100vh;
            position: relative;
            z-index: 2;
        }

        /* SIDEBAR */
        .nav-rail {
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 25px 0;
        }

        .nav-item {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: grid;
            place-items: center;
            cursor: pointer;
            opacity: 0.5;
            transition: 0.3s;
            margin-bottom: 15px;
            color: var(--text);
        }

            .nav-item.active {
                opacity: 1;
                color: var(--accent);
                background: rgba(0, 212, 255, 0.15);
                border: 1px solid var(--accent);
            }

            .nav-item svg {
                width: 24px;
                height: 24px;
                stroke: currentColor;
                fill: none;
                stroke-width: 1.5;
            }

        /* CONTENT */
        .main-view {
            display: flex;
            flex-direction: column;
            padding: 40px;
            border-right: 1px solid var(--border);
            overflow-y: auto;
        }

        .tab-content {
            display: none;
            height: 100%;
            flex-direction: column;
            animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

            .tab-content.active {
                display: flex;
            }

        /* ENHANCED NEURAL TOPOGRAPHY */
        .map-frame {
            flex-grow: 1;
            border: 1px solid var(--border);
            border-radius: 24px;
            position: relative;
            background: rgba(0,0,0,0.4);
            overflow: hidden;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .node {
            position: absolute;
            border-radius: 50%;
            z-index: 10;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.4s ease;
        }

            .node::after {
                content: '';
                position: absolute;
                width: 200%;
                height: 200%;
                border: 1px solid inherit;
                border-radius: 50%;
                opacity: 0.1;
                animation: pulse 3s infinite;
            }

        @keyframes pulse {
            0% {
                transform: scale(0.8);
                opacity: 0.3;
            }

            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }

        .node-label {
            position: absolute;
            font-family: var(--mono);
            font-size: 10px;
            bottom: -25px;
            white-space: nowrap;
            font-weight: bold;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        /* SVG ANIMATION */
        .data-path {
            stroke-dasharray: 10, 30;
            stroke-dashoffset: 40;
            animation: flow 2s linear infinite;
        }

        @keyframes flow {
            to {
                stroke-dashoffset: 0;
            }
        }

        /* LOGS */
        .history-rail {
            background: var(--sidebar-bg);
            padding: 30px;
            display: flex;
            flex-direction: column;
        }

        #log-list {
            flex-grow: 1;
            overflow-y: auto;
            font-family: var(--mono);
            font-size: 10px;
            color: rgba(255,255,255,0.5);
        }

        .log-entry {
            margin-bottom: 8px;
            padding-left: 10px;
            border-left: 1px solid var(--accent);
        }

        /* BUTTONS */
        .btn-action {
            background: var(--accent);
            color: #000;
            border: none;
            padding: 12px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            font-family: var(--mono);
            font-size: 11px;
        }
    </style>
</head>
<body>

    <canvas id="webgl-canvas"></canvas>

    <div class="app-shell">
        <nav class="nav-rail">
            <div class="nav-item active" data-tab="coordinator"><svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7" /><rect x="14" y="3" width="7" height="7" /><rect x="14" y="14" width="7" height="7" /><rect x="3" y="14" width="7" height="7" /></svg></div>
            <div class="nav-item" data-tab="network"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3" /><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z" /></svg></div>
            <div class="nav-item" data-tab="plugins"><svg viewBox="0 0 24 24"><path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z" /><polyline points="3.27 6.96 12 12.01 20.73 6.96" /><line x1="12" y1="22.08" x2="12" y2="12" /></svg></div>
            <div class="nav-item" id="theme-trigger" style="margin-top: auto;">🌙</div>
        </nav>

        <main class="main-view">
            <div id="coordinator" class="tab-content active" style="justify-content: center; align-items: center; text-align: center;">
                <h1 style="letter-spacing: 25px; font-weight: 100; font-size: 3rem; margin: 0; text-indent: 25px;">COORDINATOR</h1>
                <p style="font-family: var(--mono); color: var(--accent); opacity: 0.6; margin-top: 15px;">KERNEL v3.5 // NEURAL LINK STABLE</p>
            </div>

            <div id="network" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="letter-spacing: 2px; font-weight: 300; margin: 0;">NEURAL_TOPOGRAPHY</h2>
                    <div style="font-family: var(--mono); font-size: 10px; color: var(--accent);">SYSTEM_MAP_LOADED</div>
                </div>

                <div class="map-frame" id="neural-map">
                    <svg width="100%" height="100%" style="position: absolute; pointer-events: none;">
                        <g stroke="var(--border)" stroke-width="1" fill="none">
                            <line x1="50%" y1="50%" x2="25%" y2="25%" />
                            <line x1="50%" y1="50%" x2="75%" y2="30%" />
                            <line x1="50%" y1="50%" x2="35%" y2="75%" />
                            <line x1="50%" y1="50%" x2="80%" y2="70%" />
                        </g>
                        <g stroke="var(--accent)" stroke-width="2" fill="none" class="data-path" opacity="0.4">
                            <line x1="50%" y1="50%" x2="25%" y2="25%" />
                            <line x1="50%" y1="50%" x2="75%" y2="30%" />
                            <line x1="50%" y1="50%" x2="35%" y2="75%" />
                            <line x1="50%" y1="50%" x2="80%" y2="70%" />
                        </g>
                    </svg>

                    <div class="node" style="width: 40px; height: 40px; background: var(--accent); box-shadow: 0 0 40px var(--accent); border: 2px solid #fff;">
                        <div class="node-label" style="color: var(--accent); font-size: 11px; bottom: -30px;">CORE_CMD</div>
                    </div>

                    <div class="node" style="top: 25%; left: 25%; width: 16px; height: 16px; background: var(--color-research); box-shadow: 0 0 20px var(--color-research);">
                        <div class="node-label">RESEARCH_NODE</div>
                    </div>
                    <div class="node" style="top: 30%; left: 75%; width: 16px; height: 16px; background: var(--color-analyzer); box-shadow: 0 0 20px var(--color-analyzer);">
                        <div class="node-label">ANALYZER_NODE</div>
                    </div>
                    <div class="node" style="top: 75%; left: 35%; width: 16px; height: 16px; background: var(--color-task); box-shadow: 0 0 20px var(--color-task);">
                        <div class="node-label">EXECUTION_NODE</div>
                    </div>
                    <div class="node" style="top: 70%; left: 80%; width: 16px; height: 16px; background: var(--color-system); box-shadow: 0 0 20px var(--color-system);">
                        <div class="node-label">SYSTEM_NODE</div>
                    </div>
                </div>
            </div>

            <div id="plugins" class="tab-content">
                <h2 style="letter-spacing: 2px; font-weight: 300;">PLUGIN_REPOSITORY</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                    <div style="background: var(--card-bg); padding: 25px; border-radius: 20px; border: 1px solid var(--border);">
                        <div style="font-size: 2rem;">🧠</div>
                        <h3 style="margin: 15px 0 5px 0;">Logic Weaver</h3>
                        <p style="font-size: 12px; opacity: 0.5;">Chain reasoning modules for complex prompt engineering.</p>
                        <button class="btn-action">ENABLE MODULE</button>
                    </div>
                    <div style="background: var(--card-bg); padding: 25px; border-radius: 20px; border: 1px solid var(--border);">
                        <div style="font-size: 2rem;">🌐</div>
                        <h3 style="margin: 15px 0 5px 0;">Web Crawler</h3>
                        <p style="font-size: 12px; opacity: 0.5;">Real-time search and data mining integration.</p>
                        <button class="btn-action">ENABLE MODULE</button>
                    </div>
                </div>
            </div>
        </main>

        <aside class="history-rail">
            <div style="font-family: var(--mono); font-size: 11px; opacity: 0.4; margin-bottom: 25px;">KERNEL_LOG</div>
            <div id="log-list"></div>
        </aside>
    </div>

    <script type="importmap"> { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js", "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/" } } </script>

    <script type="module">
    import * as THREE from 'three';
    import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
    import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
    import { ShaderPass } from 'three/addons/postprocessing/ShaderPass.js';
    import { gsap } from 'https://cdn.skypack.dev/gsap';

    // 1. 3D BACKGROUND
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('webgl-canvas'), alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    const core = new THREE.Mesh(new THREE.IcosahedronGeometry(2, 2), new THREE.MeshBasicMaterial({ color: 0x00d4ff, wireframe: true, transparent: true, opacity: 0.2 }));
    scene.add(core); camera.position.z = 5;

    const composer = new EffectComposer(renderer);
    composer.addPass(new RenderPass(scene, camera));
    const dither = new ShaderPass({
        uniforms: { "tDiffuse": { value: null }, "uRes": { value: 250.0 } },
        vertexShader: `varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0); }`,
        fragmentShader: `uniform sampler2D tDiffuse; uniform float uRes; varying vec2 vUv; void main() { vec2 uv = floor(vUv * uRes) / uRes; gl_FragColor = texture2D(tDiffuse, uv); }`
    });
    composer.addPass(dither);

    function loop() { requestAnimationFrame(loop); core.rotation.y += 0.002; composer.render(); }
    loop();

    // 2. NAVIGATION HANDLER
    document.querySelectorAll('.nav-item[data-tab]').forEach(btn => {
        btn.onclick = () => {
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            const target = document.getElementById(btn.dataset.tab);
            target.classList.add('active');

            gsap.fromTo(dither.uniforms.uRes, { value: 60 }, { value: 250, duration: 0.6 });
            addLog(`MOUNTED_VIEW: ${btn.dataset.tab.toUpperCase()}`);
        };
    });

    // 3. LOGGING SYSTEM
    function addLog(msg) {
        const entry = document.createElement('div');
        entry.className = 'log-entry';
        entry.innerText = `[${new Date().toLocaleTimeString()}] ${msg}`;
        document.getElementById('log-list').prepend(entry);
    }

    // 4. THEME TOGGLE
    document.getElementById('theme-trigger').onclick = () => {
        const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', theme);
    };

    addLog("Neural OS Kernel v3.5 Initialized.");
    addLog("Neural Topography active.");
    </script>
</body>
</html>